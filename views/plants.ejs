<!DOCTYPE html>
<html lang="en">

<%- include('partials/head') %>


<body>

  <%- include('partials/nav') %>


  <section class="main-content columns is-fullheight">

    <div class="column is-2 is-narrow-mobile is-fullheight section is-hidden-mobile">
      <h5 class="title is-size-5 is-primary filter-title">Filters</h5>
      <p class="menu-label is-hidden-touch">Price</p>
      <ul class="menu-list">
        <li>
          <div class="field">
            <label class="b-radio radio">
              <input type="radio" name="group_1" value="One" checked>
              <span class="check"></span>
              <span class="control-label">All</span>
            </label>
          </div>

          <div class="field">
            <label class="b-radio radio">
              <input type="radio" name="group_1" value="Two" data-com.bitwarden.browser.user-edited="yes">
              <span class="check"></span>
              <span class="control-label">Below &#8369;100</span>
            </label>
          </div>

          <div class="field">
            <label class="b-radio radio">
              <input type="radio" name="group_1" value="Three" data-com.bitwarden.browser.user-edited="yes">
              <span class="check"></span>
              <span class="control-label">&#8369;100 - &#8369;300</span>
            </label>
          </div>

          <div class="field">
            <label class="b-radio radio">
              <input type="radio" name="group_1" value="Four" data-com.bitwarden.browser.user-edited="yes">
              <span class="check"></span>
              <span class="control-label">Above &#8369;300</span>
            </label>
          </div>
        </li>
      </ul>

      <p class="menu-label is-hidden-touch">Category</p>
      <ul class="menu-list">
        <li>
          <div class="container">

            <div class="field">
              <label class="b-checkbox checkbox">
                <input type="checkbox" value="Succulent with Pots">
                <span class="check"></span>
                <span class="control-label">Succulent with Pots</span>
              </label>
            </div>

            <div class="field">
              <label class="b-checkbox checkbox">
                <input type="checkbox" value="Succulent without Pots">
                <span class="check"></span>
                <span class="control-label">Succulent without Pots</span>
              </label>
            </div>

            <div class="field">
              <label class="b-checkbox checkbox">
                <input type="checkbox" value="Moon Cactus">
                <span class="check"></span>
                <span class="control-label">Moon Cactus</span>
              </label>
            </div>

            <div class="field">
              <label class="b-checkbox checkbox">
                <input type="checkbox" value="Air Plants">
                <span class="check"></span>
                <span class="control-label">Air Plants</span>
              </label>
            </div>

            <div class="field">
              <label class="b-checkbox checkbox">
                <input type="checkbox" value="Hanging Plants">
                <span class="check"></span>
                <span class="control-label">Hanging Plants</span>
              </label>
            </div>

            <div class="field">
              <label class="b-checkbox checkbox">
                <input type="checkbox" value="Pots">
                <span class="check"></span>
                <span class="control-label">Pots</span>
              </label>
            </div>
          </div>
        </li>
      </ul>
    </div>

    <div class="column is-10">
      <div class="level">
        <div class="level-item level-left">
          <h4 class="title is-size-4 mt-5 mx-5 is-primary">
            Indoor Plants
          </h4>
          <h2>Found <%= search_result.length %> plants!</h2>

        </div>
        <div class="level-item level-right mx-5">
          <div id="sortDropdown" class="dropdown is-right">
            <div class="dropdown-trigger">
              <button class="button" aria-haspopup="true" aria-controls="dropdown-menu"
                style="width:100px; border: 2px solid #9baa9f">
                <span>Sort by</span>
                <span class="icon is-small">
                  <i class="fa fa-angle-down" aria-hidden="true"></i>
                </span>
              </button>
            </div>
            <div class="dropdown-menu" id="dropdown-menu" role="menu">
              <div class="dropdown-content">
                <a href="#" class="dropdown-item is-active">
                  Alphabetically, A-Z
                </a>
                <a class="dropdown-item">
                  Alphabetically, Z-A
                </a>
                <a href="#" class="dropdown-item">
                  Price, low to high
                </a>
                <a href="#" class="dropdown-item">
                  Price, high to low
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="container">
        <div id='products-container' class="columns mt-5 mx-2 is-centered is-multiline">
          <!-- 
            SAMPLE PRODUCT-ITEM
            <a href="product_item.html" class="product-item">
            <div class="column is-3-desktop">
              <div class="card">
                <div class="card-image has-text-centered pt-4 px-2">
                  <img src="https://unsplash.it/g/300/300" alt="">
                </div>
                <div class="card-content">
                  <p class="price">&#8369;0.00</p>
                  <p class="title is-size-5 has-text-primary">Plant Name</p>
                </div>
                <a href="" class="addCartBtn">
                  <footer class="card-footer">
                    <p class="card-footer-item">
                      <span class="icon is-medium">
                        <i class="fas fa-shopping-cart"></i>
                      </span>
                      <span>Add to Cart</span>
                    </p>
                  </footer>
                </a>
              </div>
            </div>
          </a> 
        -->
        </div>
      </div>
    </div>
  </section>

  <div class="container">
    <p class="has-text-centered is-italic">
      "In my garden there is a large place for sentiment. My garden of flowers is also my garden of thoughts and dreams.
      The thoughts grow as freely as the flowers, and the dreams are [just] as beautiful"
    </p>
    <br>
    <p class="has-text-centered">
      - Abraham Lincoln
    </p>
    <br>
  </div>

  <%- include('partials/footer') %>

    <script src="scripts/target.js"></script>
    <script src="scripts/plant.js"></script>
    <script src="scripts/script.js"></script>
    <script>
      var plants = '<%- JSON.stringify(search_result) %>';
      plants = JSON.parse(plants);
      const productsContainer = document.getElementById('products-container');

      // add plant search results in products container
      plants.forEach(plant => {
        productsContainer.innerHTML += 
      '<a class="product-item">\
            <div class="column is-3-desktop">\
              <div class="card">\
                <div class="card-image has-text-centered pt-4 px-2">\
                  <img src="'+ plant.image_path +'" alt="">\
                </div>\
                <div class="card-content">\
                  <p class="price">&#8369;'+ plant.price.$numberDecimal +'</p>\
                  <p class="title is-size-5 has-text-primary">'+ plant.plant_name +'</p>\
                </div>\
                <a onclick="'+ "addToCart(this);" +'" class="addCartBtn">\
                  <footer class="card-footer">\
                    <p class="card-footer-item">\
                      <span class="icon is-medium">\
                        <i class="fas fa-shopping-cart"></i>\
                      </span>\
                      <span>Add to Cart</span>\
                    </p>\
                  </footer>\
                  <input type="hidden" value="'+ plant._id +'">\
                </a>\
              </div>\
            </div>\
          </a>';
      })
      
      function addToCart(e){
        let plantID = e.querySelector('input').value;

        fetch('/plants/add_to_cart', {
            method: 'POST',
            headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                plant_id: plantID,
                amount: 1,
                action: 'add'
            })
        })
        .then(async response => {
            let data = await response.json();
            updateNavCart(data);
        });
      }

      document.addEventListener('DOMContentLoaded', () => {

        const $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0);

        if ($navbarBurgers.length > 0) {

          $navbarBurgers.forEach(el => {
            el.addEventListener('click', () => {

              const target = el.dataset.target;
              const $target = document.getElementById(target);

              el.classList.toggle('is-active');
              $target.classList.toggle('is-active');

            });
          });
        }

      });
      $(document).ready(function () {

        $(".navbar-burger").click(function () {

          $(".navbar-burger").toggleClass("is-active");
          $(".navbar-menu").toggleClass("is-active");

        });
      });
    </script>
</body>

</html>